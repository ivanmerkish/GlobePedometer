# Project Specification: GlobePedometer (Earth Run)

## 1. –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
**GlobePedometer** ‚Äî —ç—Ç–æ —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ (serverless) –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É—é—â–µ–µ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–∞–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ —ç–∫–≤–∞—Ç–æ—Ä—É –ó–µ–º–ª–∏.

*   **–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–≤–æ–¥—è—Ç —Å–≤–æ–∏ —à–∞–≥–∏, —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∏—Ö –≤ –∫–∏–ª–æ–º–µ—Ç—Ä—ã –∏ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –∞–≤–∞—Ç–∞—Ä –Ω–∞ –≤–æ—Å—Ç–æ–∫ –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ (–ù—É–ª–µ–≤–æ–π –º–µ—Ä–∏–¥–∏–∞–Ω / –ö–µ–Ω–∏—è).
*   **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:** –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π 3D-–≥–ª–æ–±—É—Å —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
*   **–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è:** –í—ã–±–æ—Ä –∞–≤–∞—Ç–∞—Ä–æ–≤, "—Å–æ–Ω–∞—Ä–Ω–∞—è" –ø–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ–Ω–Ω–æ–≥–æ –ø—É—Ç–∏ –ø—É–Ω–∫—Ç–∏—Ä–Ω–æ–π –ª–∏–Ω–∏–µ–π.

## 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ –∏ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Frontend
*   **–Ø–∑—ã–∫:** JavaScript (ES6 Modules).
*   **–°–±–æ—Ä–∫–∞:** Native ES Modules (–±–µ–∑ Webpack/Vite), —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
*   **3D –î–≤–∏–∂–æ–∫:** `globe.gl` (–æ–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ Three.js).
*   **–•–æ—Å—Ç–∏–Ω–≥:** GitHub Pages.

### Backend (BaaS)
*   **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** Supabase.
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL.
*   **Auth:** Google OAuth 2.0 (—á–µ—Ä–µ–∑ Supabase Auth).
*   **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** RLS (Row Level Security) –ø–æ–ª–∏—Ç–∏–∫–∏.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
*   `index.html` ‚Äî –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –≤–µ—Ä—Å—Ç–∫–∞ UI.
*   `style.css` ‚Äî –°—Ç–∏–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω.
*   `main.js` ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (UI, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, —Ü–∏–∫–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π).
*   `globe.js` ‚Äî –õ–æ–≥–∏–∫–∞ 3D-—Å—Ü–µ–Ω—ã (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª–æ–±—É—Å–∞, —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –º–∞—Ä–∫–µ—Ä–æ–≤ –∏ –ø—É—Ç–µ–π, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ WebGL).
*   `dbapi.js` ‚Äî –°–ª–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Supabase (Auth, CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏).
*   `utils.js` ‚Äî –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—É—Ç–µ–π.
*   `config.js` ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –∫–ª—é—á–∏ API, —Å–ø–∏—Å–∫–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤.

## 3. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### 3.1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ü—Ä–æ—Ñ–∏–ª—å
*   –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google SSO.
*   –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è "–û–∂–∏–¥–∞–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è" (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –≤–≤–æ–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–æ —Ñ–ª–∞–≥–∞ `is_approved` –≤ –ë–î).
*   –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è: –≤—ã–±–æ—Ä –∞–≤–∞—Ç–∞—Ä–∞ (–∏–∑ 3 –∫–∞—Ç–µ–≥–æ—Ä–∏–π: –õ—é–¥–∏, –†–æ–±–æ—Ç—ã, –ñ–∏–≤–æ—Ç–Ω—ã–µ) –∏ –Ω–∏–∫–Ω–µ–π–º–∞.
*   –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Å—Å–∏–∏ (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏).

### 3.2. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–ì–ª–æ–±—É—Å)
*   –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –∫–∞—Ä—Ç–µ.
*   **–ê–≤–∞—Ç–∞—Ä—ã:** –ú–∞—Ä–∫–µ—Ä—ã —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
*   **–ü—É—Ç–∏:** –ö—Ä–∞—Å–Ω—ã–µ –ø—É–Ω–∫—Ç–∏—Ä–Ω—ã–µ –ª–∏–Ω–∏–∏, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–µ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π –ø—É—Ç—å –æ—Ç —Å—Ç–∞—Ä—Ç–∞.
*   **–ò–Ω–¥–∏–∫–∞—Ü–∏—è:** –ü—É–ª—å—Å–∏—Ä—É—é—â–µ–µ –∫–æ–ª—å—Ü–æ –≤–æ–∫—Ä—É–≥ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
*   **–ö–∞–º–µ—Ä–∞:**
    *   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø—Ä–∏ –≤—Ö–æ–¥–µ.
    *   –ö–Ω–æ–ø–∫–∞ "–ù–∞–π—Ç–∏ –º–µ–Ω—è" (üéØ) –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–∞–º–µ—Ä—ã.
    *   –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ-–≤—Ä–∞—â–µ–Ω–∏—è –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.
*   **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:**
    *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ WebGL (—Ñ–æ–ª–±–µ–∫ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –¥—Ä–∞–π–≤–µ—Ä–∞).
    *   –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (–≥–ª–æ–±—É—Å –Ω–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å).

## 4. –°—Ö–µ–º–∞ –ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö (Supabase)

**–¢–∞–±–ª–∏—Ü–∞ `profiles`**

| Column | Type | Description |
| :--- | :--- | :--- |
| `id` | uuid (PK) | –°—Å—ã–ª–∫–∞ –Ω–∞ auth.users |
| `email` | text | Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `nickname` | text | –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è |
| `avatar_url` | text | URL –∏–∫–æ–Ω–∫–∏ |
| `total_steps` | bigint | –°—É–º–º–∞ —à–∞–≥–æ–≤ (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ) |
| `is_approved` | boolean | –§–ª–∞–≥ –¥–æ—Å—Ç—É–ø–∞ (Admin only) |
| `updated_at` | timestamp | –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è |

## 5. Roadmap & TODO

### 5.1. UX/UI: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
*   [ ] **Read-only Total:** –ü–æ–ª–µ "–û–±—â–∏–π –ø—Ä–æ–±–µ–≥" —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–º (—Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç/–∏–Ω–¥–∏–∫–∞—Ü–∏—è).
*   [ ] **Add Steps:** –ó–∞–º–µ–Ω–∏—Ç—å –ø–æ–ª–µ –≤–≤–æ–¥–∞ "–û–±—â–∏–π –ø—Ä–æ–±–µ–≥" –Ω–∞ "–î–æ–±–∞–≤–∏—Ç—å —à–∞–≥–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è".
*   [ ] **Logic:** –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –¥–æ–ª–∂–Ω–∞ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å `total_steps`, –∞ –¥–µ–ª–∞—Ç—å: `new_total = db_total + input_value`.
    *   *–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏:* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ RPC —Ñ—É–Ω–∫—Ü–∏—é –≤ Supabase (–∞—Ç–æ–º–∞—Ä–Ω—ã–π –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç) –∏–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —á—Ç–µ–Ω–∏—è-–∑–∞–ø–∏—Å–∏.

### 5.2. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (Mobile/Desktop)
*   [ ] **–£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ç—É–ª—Ç–∏–ø—ã:**
    *   *Desktop:* –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ (Hover) ‚Äî –≤—Å–ø–ª—ã–≤–∞—é—â–∞—è –ø–ª–∞—à–∫–∞ —Å –∏–º–µ–Ω–µ–º –∏ –∫–º .
    *   *Touch:* –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ (Tap) –Ω–∞ —á—É–∂–æ–π –∞–≤–∞—Ç–∞—Ä ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏–º—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–≤–æ–∑–º–æ–∂–Ω–æ, –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –±–ª–æ–∫–µ UI, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª–æ—Å—å –ø–∞–ª—å—Ü–µ–º).

### 5.3. AI Feature: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ (OCR)
*   [ ] **UI Upload:** –ö–Ω–æ–ø–∫–∞ (—Å–∫—Ä–µ–ø–∫–∞/–∫–∞–º–µ—Ä–∞) –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —à–∞–≥–æ–º–µ—Ä–∞ (Apple Health, Samsung Health).
*   [ ] **Backend Logic:**
    *   –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ Supabase Storage.
    *   Supabase Edge Function (—Ç—Ä–∏–≥–≥–µ—Ä –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É).
*   [ ] **AI Integration:** –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ Vision LLM (GPT-4o / Gemini Flash) —Å –ø—Ä–æ–º–ø—Ç–æ–º: *"Extract the daily step count from this screenshot. Return only the number."*
*   [ ] **Auto-update:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ –∫ —Å—É–º–º–µ —à–∞–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### 5.4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥
*   [x] –í—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É —Ä–∞—Å—á–µ—Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–≥—Ä–∞–¥—É—Å—ã/–º–µ—Ç—Ä—ã) –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–π –∫–ª–∞—Å—Å/–º–æ–¥—É–ª—å (`utils.js`).

### 5.5. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
*   [ ] **Backend:** –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å Supabase Edge Function `auth-bridge`.
    *   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Supabase CLI.
    *   –ö–æ–º–∞–Ω–¥–∞: `supabase functions deploy auth-bridge --no-verify-jwt`
    *   –°–µ–∫—Ä–µ—Ç—ã: –î–æ–±–∞–≤–∏—Ç—å `TELEGRAM_BOT_TOKEN` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Supabase Dashboard.
*   [ ] **Frontend (Telegram):**
    *   –î–æ–±–∞–≤–∏—Ç—å Telegram Login Widget –≤ `index.html`.
    *   –í `dbapi.js` –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `signInWithTelegram(data)`.
    *   –õ–æ–≥–∏–∫–∞: –í–∏–¥–∂–µ—Ç -> –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö -> –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ `auth-bridge` -> –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ -> –í—Ö–æ–¥.
*   [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ **VK** (–í–ö–æ–Ω—Ç–∞–∫—Ç–µ).
*   [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ **Yandex**.